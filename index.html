<!DOCTYPE html>
<html lang="nl">

<head>
  <meta charset="UTF-8">
  <title>GeoGuessr Hint Game</title>
  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
  <style>
    h2 {
      margin-left: 45px;
    }

    #map {
      height: 500px;
      margin-top: 20px;
    }

    #hint-container {
      font-size: 20px;
      font-weight: bold;
      margin-bottom: 10px;
    }

    #score {
      font-size: 18px;
      margin-top: 10px;
    }

    #locations-list {
      margin-top: 20px;
    }

    .location-item {
      cursor: pointer;
      list-style-type: none;
      padding: 8px;
      background-color: #f0f0f0;
      margin: 5px 0;
      border-radius: 5px;
      transition: background-color 0.3s;
    }

    .location-item:hover {
      background-color: #ddd;
    }

    .location-item.selected {
      background-color: #a0c8e0;
      /* Blauw */
    }

    .location-item.correct {
      background-color: #78c778;
      /* Groen voor goed antwoord */
      pointer-events: none;
      /* Maakt de locatie niet meer aanklikbaar */
    }

    .hint-text {
      display: none;
      margin-top: 5px;
      font-style: italic;
    }

    .hint-text.show {
      display: block;
    }

    .checkmark {
      margin-left: 10px;
      color: white;
      font-weight: bold;
    }
  </style>
</head>

<body>

  <h2>Raad de locatie op basis van de hint!</h2>

  <button id="reset-button"
    style="position: fixed; top: 10px; right: 10px; font-size: 18px; padding: 10px 15px; background-color: #f44336; color: white; border: none; border-radius: 5px; cursor: pointer;">
    Reset
  </button>


  <!-- Genummerde lijst van locaties -->
  <div id="locations-list">
    <ul>
      <!-- Dynamisch de locaties toevoegen -->
    </ul>
  </div>

  <audio id="congratulations-sound" src="sound.mp3" preload="auto"></audio>
  <img id="congratulations-image" src="image.jpg"
    style="display:none; position: fixed; top: 0; left: 0; width: 100vw; height: 100vh; object-fit: cover;" />


  <div id="map"></div>
  <div id="score">Score: 0</div>

  <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
  <script>
    // ----------------- DATA -----------------
    const locations = [
      {
        name: "De bekende schrijver",
        hint: "Een bekende schrijver overleefde een vliegtuigcrash, vocht in een oorlog, en schreef later over een oude man en een vis. In welke stad werd hij geboren?",
        lat: 41.8878145,
        lng: -87.7887615,
        radius: 4
      },
      {
        name: "Leeuwen standbeeld",
        hint: "Een beroemd standbeeld in AziÃ« lijkt op een leeuw die water spuwt. Het lichaam is echter geen leeuw. Ga naar het standbeeld",
        lat: 1.2867841,
        lng: 103.8545035,
        radius: 0.2
      },
      {
        name: "Beetje nat",
        hint: "Als je zout bij je friet wilt hebben, zou ik dit stukje water pakken.",
        lat: 31.5414738,
        lng: 35.4787059,
        radius: 50
      },
      {
        name: "Rivieren race",
        hint: "Dit rivieren onderling houden een wedstrijd wie de meeste landen ziet, we gaan naar de oorsprong van de winnaar",
        lat: 47.95183609837859,
        lng: 8.502578049847092,
        radius: 0.02
      },
      {
        name: "Wat zeg je?",
        hint: "Je kan fluisteren wat je wilt, maar iedereen hoort je in dit gebouw brits praten.",
        lat: 51.51383972167969,
        lng: -0.0982590988278389,
        radius: 30
      },
      {
        name: "Macro foto?",
        hint: "Deze incecten hebben op de foto gestaan toen ze de wereld verranderde",
        lat: 51.53208474855893,
        lng: -0.17734928191069477,
        radius: 0.005
      },
      {
        name: "Computerpraat",
        hint: "01000111 01100001 00100000 01101110 01100001 01100001 01110010 00100000 01101000 01100101 01110100 00100000 01101111 01110000 01100101 01110010 01100001 00101101 01101000 01110101 01101001 01110011 00100000 01101001 01101110 00100000 01010011 01111001 01100100 01101110 01100101 01111001",
        lat: -33.857276182038945,
        lng: 151.21494997329745,
        radius: 0.02
      },
      {
        name: "Cgz hkzkqktz joz?",
        hint: "Een romeinse leider en iets wat Thom nooit zal eten in zijn leven. Het cijfer 6 is belangrijk",
        lat: 10.91882052026577,
        lng: 139.96362647573747,
        radius: 400
      },
      {
        name: "Niet de Gamecube maar de?",
        hint: "Nintendo heeft hier een console van: V2UgZ2FhbiBuYWFyIFNjb3V0aW5nIHRvZQ==",
        lat: 51.529314741564455,
        lng: 4.448739025175779,
        radius: 0.02
      },
      {
        name: "Motherf*cking windmills",
        hint: "Ik wil naar deze locatie, https://www.youtube.com/watch?v=bunG-GGqzQc",
        lat: 56.038474289396895,
        lng: 8.006029606252142,
        radius: 10
      },
      {
        name: "Rare machine",
        hint: "3 rotoren, 26 lampjes, 4 landen en een plugboard? We gaan naar de geboorteplaats van de uitvinder",
        lat: 50.1106444,
        lng: 8.6820917,
        radius: 9
      },
      {
        name: "Switch it up like nintendo",
        hint: "We gaan naar de bocht uit dit filmpje. https://files.iscoutgame.com/game-2025/road.mp4",
        lat: 18.71237844228911,
        lng: -97.3293917373196,
        radius: 5
      },
      {
        name: "Kunnen we deze PDF aanpassen?",
        hint: "PDF's gebruiken we allemaal. Vaak in het formaat van een A4'tje, bijvoorbeeld met doe-opdrachten erop. Een PDF kan allerlei formaten hebben, maar er is wel een maximale grootte. Stel, we leggen de linkerbovenhoek op het wereldwijde hoofdkwartier van Adobe. We reizen naar de rechter onderhoek.",
        lat: 33.83042923993267,
        lng: -117.76877338191034,
        radius: 200
      },
      {
        name: "Kedeng kedeng",
        hint: "Fans van treinen heb je overal. We gaan naar het station waar fans bijzonder teleurgesteld waren omdat de 'trein' van 11:00 niet vertrok.",
        lat: -33.874605701265914,
        lng: 151.22245725661634,
        radius: 0.01
      },
      {
        name: "Looks like Senegal radiance",
        hint: "Er zijn mensen die bij het spel GeoGuesser aan de kleur van een paaltje langs de weg kunnen zien in wel land ze zijn. Dat kunnen jullie vast ook. We gaan naar het land van dit paaltje: https://files.iscoutgame.com/game-2025/bollard.png",
        lat: 8.0300284,
        lng: -1.0800271,
        radius: 250
      },
      {
        name: "Nonogram?",
        hint: "Los de puzzel op: https://files.iscoutgame.com/game-2024/puzzle2.png",
        lat: 48.900711445712965,
        lng: 93.45494595476013,
        radius: 50
      },
      {
        name: "Hammond you blithering idiot",
        hint: "Ga naar deze tent https://www.youtube.com/watch?v=mA57X_BWbUA&list=PL6idMvMGyE3IEA2m6VMoBUwwAWgsrBPvI&index=15",
        lat: 49.16377961838467,
        lng: 97.40827556282149,
        radius: 100
      },
      {
        name: "Boeing 747",
        hint: "Een bedrijf heeft speciaal voor zijn klanten een werknemers een prive vliegveld geopend, waar?",
        lat: 55.7409551,
        lng: 9.1521722,
        radius: 2
      },
      {
        name: "Second breakfast?",
        hint: "'Shall I describe it to you, or would you like me to find you a box?'. We willen naar de film locatie",
        lat: -41.150267,
        lng: 174.979046,
        radius: 10
      },
      {
        name: "Vliegveld",
        hint: "Sommige vliegvelden liggen dicht bij de centrum van de stad waar het vliegveld naar vernoemd is. Bijvoorbeeld London City Airport ligt op nog geen 10 km van Londen. Andere vliegvelden zijn misleidend, en liggen ver bij de stad vandaan waar ze naar vernoemd zijn. Wij gaan naar het meest misleidende vliegveld (dat ligt nog circa 135 km hemelsbreed van de stad vandaan)",
        lat: 48.77786604783219,
        lng: 4.186261187089951,
        radius: 2
      },
      {
        name: "Spongebob",
        hint: "In deze straat woont spongebob",
        lat: 51.53202603643356,
        lng: 4.271922364356801,
        radius: 0.2
      },
      {
        name: "Zuidelijke stad",
        hint: "Dit is de meest zuidelijke stad ter wereld.",
        lat: -54.8088106,
        lng: -68.3199749,
        radius: 5
      },
      {
        name: "Eiffeltoren",
        hint: "Een beroemd ijzeren bouwwerk in Parijs, Frankrijk.",
        lat: 48.8584,
        lng: 2.2945,
        radius: 0.3 // km
      },
      {
        name: "Amsterdam Centraal",
        hint: "Het belangrijkste treinstation in de hoofdstad van Nederland.",
        lat: 52.3780,
        lng: 4.9000,
        radius: 0.3 // km
      },
      {
        name: "Colosseum",
        hint: "Een oud amfitheater in Rome waar gladiatoren vochten.",
        lat: 41.8902,
        lng: 12.4922,
        radius: 0.3 // km
      },
      {
        name: "Lego",
        hint: "In dit land worden de meeste banden gemaakt",
        lat: 56.02453877107302,
        lng: 10.521098060541842,
        radius: 300
      },
    ];

    let currentLocation = null;

    // ----------------- INIT MAP -----------------
    let map = L.map('map').setView([20, 0], 2);
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
      attribution: '&copy; OpenStreetMap contributors'
    }).addTo(map);

    // ----------------- VUL DE LOCATIES IN DE LIJST -----------------
    const locationsList = document.getElementById('locations-list').getElementsByTagName('ul')[0];

    // Laad opgeslagen correcte locaties
    // Laad correctLocations
    const correctLocations = JSON.parse(localStorage.getItem('correctLocations')) || [];

    // Zet score gelijk aan het aantal correct opgeslagen locaties
    let score = correctLocations.length;

    // Update score op de pagina
    document.getElementById('score').innerText = "Score: " + score;

    locations.forEach((location, index) => {
      const li = document.createElement('li');
      li.classList.add('location-item');
      li.innerHTML = `${index + 1}. ${location.name}`;

      // Als de locatie al correct is, voeg de juiste styling toe
      if (correctLocations.includes(location.name)) {
        li.classList.add('correct');
        li.innerHTML += ' <span class="checkmark">â</span>'; // Voeg een vinkje toe
      }

      // Maak de hint div
      const hint = document.createElement('div');
      hint.classList.add('hint-text');
      hint.innerText = location.hint;
      li.appendChild(hint);

      // Voeg click event toe
      li.addEventListener('click', () => {
        if (li.classList.contains('correct')) return; // Locatie is al correct, dus niet klikken

        // Als deze locatie al geselecteerd is, doe niets â laat de hint gewoon open
        if (li.classList.contains('selected')) {
          return; // <-- Niets sluiten
        } else {
          // Verwijder vorige selectie
          document.querySelectorAll('.location-item').forEach(item => item.classList.remove('selected'));
          document.querySelectorAll('.hint-text').forEach(h => h.classList.remove('show'));

          // Toon de geselecteerde locatie
          li.classList.add('selected');
          hint.classList.add('show');
          currentLocation = location;

          // Toon de hint van de geselecteerde locatie en focus op de kaart
          document.getElementById('hint-container').innerText = currentLocation.hint;
          map.setView([currentLocation.lat, currentLocation.lng], 15);
        }
      });

      locationsList.appendChild(li);
    });

    // ----------------- CLICK EVENT OP DE KAART -----------------
    map.on('click', function (e) {
      if (!currentLocation) return; // Check of er een locatie is geselecteerd

      let guessedLat = e.latlng.lat;
      let guessedLng = e.latlng.lng;

      let distance = getDistanceFromLatLonInKm(
        currentLocation.lat,
        currentLocation.lng,
        guessedLat,
        guessedLng
      );

      if (distance <= currentLocation.radius) {
        alert("Goed! Binnen het gebied!");

        // Maak de geselecteerde locatie groen met vinkje
        const locationItem = Array.from(locationsList.getElementsByClassName('location-item')).find(item => item.innerText.includes(currentLocation.name));
        locationItem.classList.add('correct');
        locationItem.innerHTML += ' <span class="checkmark">â</span>'; // Voeg een vinkje toe

        // Voeg de locatie toe aan localStorage als correct
        correctLocations.push(currentLocation.name);
        localStorage.setItem('correctLocations', JSON.stringify(correctLocations));

        // Update score before storing it in localStorage
        // score++; // Increase score for each correct location
        // localStorage.setItem('score', score); // Store the updated score in localStorage

        // Update the score display
        score = correctLocations.length;
        document.getElementById('score').innerText = "Score: " + score;

        // Proceed to the next round
        nextRound();

        // Verberg de hint en reset de geselecteerde locatie
        document.getElementById('hint-container').innerText = "Selecteer een locatie om te beginnen.";
      } else {
        alert("Fout! Probeer het nog eens.");
      }
    });

    // ----------------- HELPER FUNCTIES -----------------
    function getDistanceFromLatLonInKm(lat1, lon1, lat2, lon2) {
      let R = 6371;
      let dLat = deg2rad(lat2 - lat1);
      let dLon = deg2rad(lon2 - lon1);
      let a = Math.sin(dLat / 2) * Math.sin(dLat / 2) +
        Math.cos(deg2rad(lat1)) * Math.cos(deg2rad(lat2)) *
        Math.sin(dLon / 2) * Math.sin(dLon / 2);
      let c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));
      return R * c;
    }

    function deg2rad(deg) {
      return deg * (Math.PI / 180);
    }

    // ----------------- RESET FUNCTIONALITEIT -----------------
    document.getElementById('reset-button').addEventListener('click', function () {
      // Reset de score
      // Reset de lijst van correcte locaties
      
      localStorage.removeItem('score')
      score = 0;
      document.getElementById('score').innerText = "Score: " + score;
      
      localStorage.removeItem('correctLocations');
      correctLocations.length = 0;
      score = correctLocations.length;
      // Verwijder de groene markering en vinkjes van alle locaties
      const locationItems = document.querySelectorAll('.location-item');
      locationItems.forEach(item => {
        item.classList.remove('correct');
        item.classList.remove('selected');
        const checkmark = item.querySelector('.checkmark');
        if (checkmark) checkmark.remove();
      });
      
      // Reset de kaart en hint
      map.setView([20, 0], 2);  // Reset de kaart naar de standaard locatie
      document.getElementById('hint-container').innerText = "Selecteer een locatie om te beginnen.";
    });


    function nextRound() {
      currentLocation = null; // Reset de locatie
      document.getElementById('hint-container').innerText = "Selecteer een locatie om te beginnen.";
      map.setView([20, 0], 2); // Reset zoom en center

      // Check of alle vragen correct beantwoord zijn
      if (correctLocations.length === locations.length) {
        // Als alle locaties correct zijn, speel een geluid af en toon een afbeelding
        const congratulationsSound = document.getElementById('congratulations-sound');
        const congratulationsImage = document.getElementById('congratulations-image');

        // Speel het geluid af
        congratulationsSound.play();

        // Toon de afbeelding in volledig scherm
        congratulationsImage.style.display = 'block';

        // Voeg een timer toe om de afbeelding na enkele seconden te verbergen (optioneel)
        setTimeout(() => {
          congratulationsImage.style.display = 'none';  // Verberg de afbeelding na 5 seconden
        }, 5000);  // Verberg de afbeelding na 5 seconden
      }
    }

  </script>
</body>

</html>